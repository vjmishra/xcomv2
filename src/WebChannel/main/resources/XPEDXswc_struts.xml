<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
  <bean type="org.apache.struts2.dispatcher.mapper.ActionMapper"
        name="swcStrutsMapper"
        class="com.sterlingcommerce.webchannel.common.ParamAttachMapper" />
  <bean type="com.opensymphony.xwork2.ActionProxyFactory"
        name="swcStrutsActionProxyFactory"
        class="com.sterlingcommerce.webchannel.common.WCActionProxyFactory" />
  <constant name="struts.mapper.class" value="swcStrutsMapper"/>
  <constant name="struts.actionProxyFactory" value="swcStrutsActionProxyFactory"/>

  <include file="com/sterlingcommerce/webchannel/home/home-struts.xml" />
  <include file="com/sterlingcommerce/webchannel/catalog/catalog-struts.xml" />
  <include file="com/sterlingcommerce/webchannel/order/struts.xml" />
  <include file="com/sterlingcommerce/webchannel/common/common-struts.xml" />
  <include file="com/sterlingcommerce/webchannel/profile/org/customer-struts.xml" />
  <include file="com/sterlingcommerce/webchannel/profile/user/user-struts.xml"/>
  <include file="com/sterlingcommerce/webchannel/misc/misc-struts.xml"/>

  <!--
    Configuration for the web channel default package. Any changes made in
    this package should also be replicated in wcJsonDefault package.
    Only difference between these two packages is the package they extend to.
    wcDefault extends to struts-default. wcJsonDefault extends to
    json-default which in turn extends to struts-default.
    -->
  <package name="wcDefault" extends="struts-default">
    <interceptors>
      <!-- WCContext injector interceptor definition -->
      <interceptor name="wcContextInjector"
          class="com.sterlingcommerce.xpedx.webchannel.core.context.XPEDXWCContextInjectorInterceptor"/>
      <!-- Ognl stack modifier interceptor definition -->
      <interceptor name="ognlStackModifier"
          class="com.sterlingcommerce.webchannel.core.binding.OgnlStackModifierInterceptor"/>
      <!--  XmlBindingStack injector interceptor definition -->
      <interceptor name="wcBindingStackInjector"
          class="com.sterlingcommerce.webchannel.core.binding.WCXmlBindingStackInjectorInterceptor"/>
      <!-- Action authorizer interceptor definition -->
      <interceptor name="wcAuthorizationIterceptor"
          class="com.sterlingcommerce.webchannel.core.wcaas.WCAuthorizationInterceptor"/>
      <!-- Action application flow interceptor definition -->
      <interceptor name="wcAppFlowInterceptor" class="com.sterlingcommerce.webchannel.common.flow.WCAppFlowInterceptor"/>
        <!-- Action server side validation interceptor definition -->
      <interceptor name="wcServerSideValidationInterceptor" class="com.sterlingcommerce.webchannel.core.validators.WCServerSideValidationInterceptor"/>

      <!-- hle - add timing logging info -->
      <interceptor name="wcTimingLoggingInterceptor"
          class="com.sterlingcommerce.webchannel.core.WCTimingLoggingInterceptor"/>

      <!-- Web Channel default stack definition -->
      <interceptor-stack name="wcStack">
        <!-- default struts2 interceptor stack -->
        <interceptor-ref name="defaultStack">
        <param name="params.excludeParams">sfId</param>
        </interceptor-ref>
        <!-- interceptor to add timing for action/result -->
        <interceptor-ref name="wcTimingLoggingInterceptor"/>
        <!--  web channel context injector  -->
        <interceptor-ref name="wcContextInjector"/>
        <!-- Action authorizer interceptor -->
        <interceptor-ref name="wcAuthorizationIterceptor"/>
        <!-- ognl stack modifier interceptor -->
        <interceptor-ref name="ognlStackModifier"/>
        <!--  web channel binding stack injector -->
        <interceptor-ref name="wcBindingStackInjector"/>
        <!--  web channel app flow interceptor -->
        <interceptor-ref name="wcAppFlowInterceptor"/>
        <!--  web channel server side validation interceptor -->
        <interceptor-ref name="wcServerSideValidationInterceptor"/>
        <!--  Prepare interceptor -->
        <interceptor-ref name="prepare"/>
      </interceptor-stack>
    </interceptors>

    <default-interceptor-ref name="wcStack"/>

    <!-- Global Result mappings -->
    <global-results>
      <!-- Handle exceptions -->
      <result name="Exception">/swc/jsp/error.jsp</result>
      <!-- Generic Errors -->
      <result name="error">/swc/jsp/error.jsp</result>
      <!-- Authorization error -->
      <result name="AuthorizationFailure">/swc/jsp/error.jsp</result>
      <!-- AuthorizationRequired -->
      <!-- 
      <result name="AuthorizationRequired" type="redirectAction">
          <param name="actionName">loginFullPage</param>
          <param name="namespace">/home</param>
      </result>
       -->
      <result name="AuthorizationRequired">/swc/jsp/home/loginRedirector.jsp</result>      
      <!-- Do not believe these are in use -->
      <result name="MASHUPERROR">/swc/jsp/error.jsp</result>
      <result name="VALIDATIONERROR">/swc/jsp/error.jsp</result>
      <result name="AUTHORIZATIONERROR">/swc/jsp/error.jsp</result>
      <result name="errorSQL">/swc/jsp/error.jsp</result>
      <result name="APIERROR">/swc/jsp/error.jsp</result>
      <result name="ValidationFailure">/swc/jsp/validationError.jsp</result>
    </global-results>


    <!-- Global Exception mappings -->
    <global-exception-mappings>
      <exception-mapping exception="java.lang.Throwable" result="Exception"/>
    </global-exception-mappings>
  </package>

  <!-- Configuration for the web channel validation and other Json based actions. -->
  <package name="wcJsonDefault" extends="json-default">
    <interceptors>
      <!-- WCContext injector interceptor definition -->
      <interceptor name="wcContextInjector"
          class="com.sterlingcommerce.webchannel.core.context.WCContextInjectorInterceptor"/>
      <!-- Ognl stack modifier interceptor definition -->
      <interceptor name="ognlStackModifier"
          class="com.sterlingcommerce.webchannel.core.binding.OgnlStackModifierInterceptor"/>
      <!--  XmlBindingStack injector interceptor definition -->
      <interceptor name="wcBindingStackInjector"
          class="com.sterlingcommerce.webchannel.core.binding.WCXmlBindingStackInjectorInterceptor"/>
      <!-- Action authorizer interceptor definition -->
      <interceptor name="wcAuthorizationIterceptor"
          class="com.sterlingcommerce.webchannel.core.wcaas.WCAuthorizationInterceptor"/>
      <!-- Action application flow interceptor definition -->
      <interceptor name="wcAppFlowInterceptor" class="com.sterlingcommerce.webchannel.common.flow.WCAppFlowInterceptor"/>

      <!-- Web Channel default stack definition -->
      <interceptor-stack name="wcStack">
        <!-- default struts2 interceptor stack -->
        <interceptor-ref name="defaultStack">
        <param name="params.excludeParams">sfId</param>
        </interceptor-ref>
        <!--  web channel context injector  -->
        <interceptor-ref name="wcContextInjector"/>
        <!-- Action authorizer interceptor -->
        <interceptor-ref name="wcAuthorizationIterceptor"/>
        <!-- ognl stack modifier interceptor -->
        <interceptor-ref name="ognlStackModifier"/>
        <!--  web channel binding stack injector -->
        <interceptor-ref name="wcBindingStackInjector"/>
        <!--  web channel app flow interceptor -->
        <interceptor-ref name="wcAppFlowInterceptor"/>
        <!--  Prepare interceptor -->
        <interceptor-ref name="prepare"/>
      </interceptor-stack>

    </interceptors>

    <default-interceptor-ref name="wcStack"/>

    <!-- Global Result mappings -->
    <global-results>
      <!-- Handle exceptions -->
      <result name="Exception">/swc/jsp/error.jsp</result>
      <!-- Authorization error -->
      <result name="AuthorizationFailure">/swc/jsp/error.jsp</result>
      <!-- AuthorizationRequired -->
      <!--
      <result name="AuthorizationRequired" type="redirectAction">
          <param name="actionName">loginFullPage</param>
          <param name="namespace">/home</param>
      </result>
       -->
      <result name="AuthorizationRequired">/swc/jsp/home/loginRedirector.jsp</result>
    </global-results>

    <!-- Global Exception mappings -->
    <global-exception-mappings>
      <exception-mapping exception="java.lang.Throwable" result="Exception"/>
    </global-exception-mappings>
  </package>

  <!-- Configuration for the web channel included/widget pages -->
  <package name="wcDefaultFragment" extends="wcDefault">
    <!-- Global Result mappings -->
    <global-results>
      <!-- Handle exceptions -->
      <result name="Exception">/swc/jsp/errorFragment.jsp</result>
      <!-- Generic errors -->
      <result name="error">/swc/jsp/errorFragment.jsp</result>
      <!-- Authorization error -->
      <result name="AuthorizationFailure">/swc/jsp/errorFragment.jsp</result>
      <!-- AuthorizationRequired -->
      <result name="AuthorizationRequired">/swc/jsp/errorFragment.jsp</result>
      <!-- Do not believe these are in use -->
      <result name="MASHUPERROR">/swc/jsp/errorFragment.jsp</result>
      <result name="VALIDATIONERROR">/swc/jsp/errorFragment.jsp</result>
      <result name="AUTHORIZATIONERROR">/swc/jsp/errorFragment.jsp</result>
      <result name="ValidationFailure">/swc/jsp/errorFragment.jsp</result>
    </global-results>
  </package>

  <!-- Configuration for the web channel included/widget pages -->
  <package name="wcDefaultAjax" extends="wcDefault">
    <!-- Global Result mappings -->
    <global-results>
        <!-- Handle exceptions -->
        <result name="Exception">/swc/jsp/errorAjax.jsp</result>
        <!-- Generic Errors -->
        <result name="error">/swc/jsp/errorAjax.jsp</result>
        <!-- Authorization error -->
        <result name="AuthorizationFailure">/swc/jsp/errorAjax.jsp</result>
        <!-- AuthorizationRequired -->
        <result name="AuthorizationRequired">/swc/jsp/errorAjax.jsp</result>
        <result name="ValidationFailure">/swc/jsp/errorAjax.jsp</result>
    </global-results>
  </package>

</struts>
